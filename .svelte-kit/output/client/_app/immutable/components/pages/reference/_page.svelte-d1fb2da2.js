import{S as x,b as L,s as P,e as _,c as F,t as T,d as y,f as k,h as c,j as I,g as O,q as b,u as h,k as g,l as C,B as R,C as N,D as S,E as q,r as G,y as z,z as H,F as J,G as K,H as M,I as Q,J as A,A as B}from"../../../chunks/index-6c37bd0f.js";import{G as U}from"../../../chunks/ag-theme-alpine-28590e6d.js";/* empty css                                                            */import{C as X}from"../../../chunks/Chasing-398c09c4.js";function W(l){let t,a,n;return a=new X({props:{size:"60",color:"#FF3E00",unit:"px",duration:"1s"}}),{c(){t=_("div"),J(a.$$.fragment),this.h()},l(r){t=y(r,"DIV",{style:!0});var o=k(t);K(a.$$.fragment,o),o.forEach(c),this.h()},h(){h(t,"display","flex"),h(t,"justify-content","center"),h(t,"padding","10px")},m(r,o){g(r,t,o),M(a,t,null),n=!0},i(r){n||(N(a.$$.fragment,r),n=!0)},o(r){S(a.$$.fragment,r),n=!1},d(r){r&&c(t),Q(a)}}}function Y(l){let t,a,n,r,o,f,p,m,u,d,v,D,w,s=l[1]&&W();return{c(){t=_("form"),a=_("input"),n=F(),s&&s.c(),r=F(),o=_("center"),f=_("h3"),p=T("Food Reference List"),m=F(),u=_("div"),d=_("div"),this.h()},l(e){t=y(e,"FORM",{action:!0,method:!0});var i=k(t);a=y(i,"INPUT",{name:!0,class:!0}),i.forEach(c),n=I(e),s&&s.l(e),r=I(e),o=y(e,"CENTER",{});var E=k(o);f=y(E,"H3",{});var V=k(f);p=O(V,"Food Reference List"),V.forEach(c),E.forEach(c),m=I(e),u=y(e,"DIV",{style:!0});var j=k(u);d=y(j,"DIV",{id:!0,class:!0,style:!0}),k(d).forEach(c),j.forEach(c),this.h()},h(){b(a,"name","food"),a.value="Search for or add food to the reference list",b(a,"class","svelte-brt59l"),b(t,"action","?/addfood"),b(t,"method","POST"),b(d,"id","datagrid"),b(d,"class","ag-theme-alpine"),h(d,"height","70vh"),h(d,"width","100%"),h(u,"display","flex"),h(u,"justify-content","center"),h(u,"align-items","center")},m(e,i){g(e,t,i),C(t,a),g(e,n,i),s&&s.m(e,i),g(e,r,i),g(e,o,i),C(o,f),C(f,p),g(e,m,i),g(e,u,i),C(u,d),l[5](d),v=!0,D||(w=[R(a,"focus",$),R(a,"keydown",l[2]),R(a,"input",l[3])],D=!0)},p(e,[i]){e[1]?s?i&2&&N(s,1):(s=W(),s.c(),N(s,1),s.m(r.parentNode,r)):s&&(A(),S(s,1,1,()=>{s=null}),q())},i(e){v||(N(s),v=!0)},o(e){S(s),v=!1},d(e){e&&c(t),e&&c(n),s&&s.d(e),e&&c(r),e&&c(o),e&&c(m),e&&c(u),l[5](null),D=!1,G(w)}}}async function Z(l,t){const a=parseInt(t.protein_grams),n=parseInt(t.carbs_grams),r=parseInt(t.fat_grams),o=a*4+n*4+r*9;console.log("protein "+a+" fat "+r+" carbs "+n+"Kcals: "+o),t.kkcals=o,l.setDataValue("kkcals",t.kkcals);const f=JSON.stringify(t);if(!(await fetch("/reference/updaterecord",{method:"POST",headers:{"Content-Type":"application/json"},body:f})).ok)throw Error(json.message)}const $=l=>l.target.select();function ee(l,t,a){let{data:n}=t;var r,o,f=!0;let p="";var m=n.rowData;let d={columnDefs:[{headerName:"Food",field:"food_name",editable:!0,minWidth:100},{headerName:"Qty",field:"food_qty",editable:!0,minWidth:70},{headerName:"Fat, g",field:"fat_grams",editable:!0,minWidth:70},{headerName:"Carbs, g",field:"carbs_grams",editable:!0,minWidth:70},{headerName:"Protein, g",field:"protein_grams",editable:!0,minWidth:70},{headerName:"Kcals",field:"kkcals",editable:!0,minWidth:120}],rowData:m,onCellValueChanged(e){Z(e.node,e.data)}};z(()=>{o=new U(r,d),a(1,f=!1)}),H(()=>{o&&o.destroy()});const v=e=>{e.key=="Enter"&&a(1,f=!0)},D=e=>{p=e.target.value,w(),d.api.setRowData(m)};function w(){m=n.rowData.filter(e=>{const i=e.food_name.toLowerCase(),E=p.toLowerCase();return i.includes(E)})}function s(e){B[e?"unshift":"push"](()=>{r=e,a(0,r)})}return l.$$set=e=>{"data"in e&&a(4,n=e.data)},[r,f,v,D,n,s]}class oe extends x{constructor(t){super(),L(this,t,ee,Y,P,{data:4})}}export{oe as default};
