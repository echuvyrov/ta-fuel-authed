import{S as we,i as Ee,s as ke,k as m,q as Y,a as P,l as h,m as T,r as Z,h as n,c as W,n as l,b as V,G as u,T as ge,P as te,g as B,v as ie,d as H,f as de,U as Oe,V as Ve,y as oe,z as ae,p as k,A as se,B as le,H as Se,e as ve,o as Pe,O as We,w as _e}from"../chunks/index.4bd8640c.js";import"../chunks/index.af0d9252.js";import"../chunks/stores.5294ae04.js";import{G as ye}from"../chunks/ag-theme-alpine.28590e6d.js";import{T as je}from"../chunks/Typeahead.588c4d72.js";/* empty css                                                      */import{C as Fe}from"../chunks/Chasing.1e199912.js";function be(a){let t,o,e;return o=new Fe({props:{size:"60",color:"#FF3E00",unit:"px",duration:"1s"}}),{c(){t=m("div"),oe(o.$$.fragment),this.h()},l(s){t=h(s,"DIV",{style:!0});var i=T(t);ae(o.$$.fragment,i),i.forEach(n),this.h()},h(){k(t,"display","flex"),k(t,"justify-content","center"),k(t,"padding","10px")},m(s,i){V(s,t,i),se(o,t,null),e=!0},i(s){e||(B(o.$$.fragment,s),e=!0)},o(s){H(o.$$.fragment,s),e=!1},d(s){s&&n(t),le(o)}}}function Te(a){let t,o;return{c(){t=m("textarea"),this.h()},l(e){t=h(e,"TEXTAREA",{name:!0,rows:!0,cols:!0,class:!0}),T(t).forEach(n),this.h()},h(){l(t,"name","receiverecipe"),l(t,"rows","10"),l(t,"cols","50"),t.value=o=a[7](a[0])+`
				`,l(t,"class","svelte-1en67h7")},m(e,s){V(e,t,s)},p(e,s){s&1&&o!==(o=e[7](e[0])+`
				`)&&(t.value=o)},d(e){e&&n(t)}}}function Ie(a){let t,o,e,s,i,p,d,c,j,I,g,S,b,M,D,w;return{c(){t=m("input"),o=P(),e=m("input"),s=P(),i=m("input"),p=P(),d=m("input"),c=P(),j=m("input"),I=P(),g=m("input"),S=P(),b=m("button"),M=Y("Save to Food Log"),this.h()},l(r){t=h(r,"INPUT",{type:!0,name:!0}),o=W(r),e=h(r,"INPUT",{type:!0,name:!0}),s=W(r),i=h(r,"INPUT",{type:!0,name:!0}),p=W(r),d=h(r,"INPUT",{type:!0,name:!0}),c=W(r),j=h(r,"INPUT",{type:!0,name:!0}),I=W(r),g=h(r,"INPUT",{type:!0,name:!0}),S=W(r),b=h(r,"BUTTON",{class:!0});var v=T(b);M=Z(v,"Save to Food Log"),v.forEach(n),this.h()},h(){l(t,"type","hidden"),l(t,"name","food"),t.value=a[8]().food_name,l(e,"type","hidden"),l(e,"name","food_qty"),e.value="1",l(i,"type","hidden"),l(i,"name","fat_grams"),i.value=a[8]().total_fat_grams,l(d,"type","hidden"),l(d,"name","carbs_grams"),d.value=a[8]().total_carbs_grams,l(j,"type","hidden"),l(j,"name","protein_grams"),j.value=a[8]().total_protein_grams,l(g,"type","hidden"),l(g,"name","total_kkcals"),g.value=a[8]().total_kkcals,l(b,"class","svelte-1en67h7")},m(r,v){V(r,t,v),V(r,o,v),V(r,e,v),V(r,s,v),V(r,i,v),V(r,p,v),V(r,d,v),V(r,c,v),V(r,j,v),V(r,I,v),V(r,g,v),V(r,S,v),V(r,b,v),u(b,M),D||(w=te(b,"click",a[4]),D=!0)},p:Se,d(r){r&&n(t),r&&n(o),r&&n(e),r&&n(s),r&&n(i),r&&n(p),r&&n(d),r&&n(c),r&&n(j),r&&n(I),r&&n(g),r&&n(S),r&&n(b),D=!1,w()}}}function Ke(a){let t,o,e,s,i,p,d,c,j,I,g,S,b,M,D,w,r,v,G,J,_=a[1]&&be(),N=a[0]!==""&&Te(a),F=a[0]!==""&&Ie(a);return{c(){t=m("div"),o=m("div"),e=m("h2"),s=Y(a[3]),i=P(),_&&_.c(),p=P(),d=m("form"),c=m("textarea"),j=P(),N&&N.c(),I=P(),g=m("div"),F&&F.c(),S=P(),b=m("button"),M=Y("Generate Recipe"),D=P(),w=m("button"),r=Y("Cancel"),this.h()},l(E){t=h(E,"DIV",{class:!0});var L=T(t);o=h(L,"DIV",{class:!0});var R=T(o);e=h(R,"H2",{});var U=T(e);s=Z(U,a[3]),U.forEach(n),i=W(R),_&&_.l(R),p=W(R),d=h(R,"FORM",{name:!0,action:!0,method:!0});var q=T(d);c=h(q,"TEXTAREA",{name:!0,rows:!0,cols:!0,class:!0}),T(c).forEach(n),j=W(q),N&&N.l(q),I=W(q),g=h(q,"DIV",{class:!0});var z=T(g);F&&F.l(z),S=W(z),b=h(z,"BUTTON",{class:!0});var $=T(b);M=Z($,"Generate Recipe"),$.forEach(n),D=W(z),w=h(z,"BUTTON",{class:!0});var f=T(w);r=Z(f,"Cancel"),f.forEach(n),z.forEach(n),q.forEach(n),R.forEach(n),L.forEach(n),this.h()},h(){l(c,"name","askforrecipe"),l(c,"rows","10"),l(c,"cols","50"),l(c,"class","svelte-1en67h7"),l(b,"class","svelte-1en67h7"),l(w,"class","svelte-1en67h7"),l(g,"class","buttons svelte-1en67h7"),l(d,"name","macrosgenie"),l(d,"action","?/addsuggestedfood"),l(d,"method","POST"),l(o,"class","content svelte-1en67h7"),l(t,"class","modal svelte-1en67h7")},m(E,L){V(E,t,L),u(t,o),u(o,e),u(e,s),u(o,i),_&&_.m(o,null),u(o,p),u(o,d),u(d,c),ge(c,a[2]),u(d,j),N&&N.m(d,null),u(d,I),u(d,g),F&&F.m(g,null),u(g,S),u(g,b),u(b,M),u(g,D),u(g,w),u(w,r),v=!0,G||(J=[te(c,"input",a[10]),te(b,"click",a[6]),te(w,"click",a[5])],G=!0)},p(E,[L]){E[1]?_?L&2&&B(_,1):(_=be(),_.c(),B(_,1),_.m(o,p)):_&&(ie(),H(_,1,1,()=>{_=null}),de()),L&4&&ge(c,E[2]),E[0]!==""?N?N.p(E,L):(N=Te(E),N.c(),N.m(d,I)):N&&(N.d(1),N=null),E[0]!==""?F?F.p(E,L):(F=Ie(E),F.c(),F.m(g,S)):F&&(F.d(1),F=null)},i(E){v||(B(_),v=!0)},o(E){H(_),v=!1},d(E){E&&n(t),_&&_.d(),N&&N.d(),F&&F.d(),G=!1,Oe(J)}}}function Re(a,t,o){let{totalsData:e}=t;const s=Ve();let i="";var p=!1;let d="Modify the text below (or leave as is) to generate food ideas",c=`Please suggest a vegetarian recipe to fit the following macros. 

Fat: `+e[2].fat_grams+" grams, Carbs: "+e[2].carbs_grams+` grams, 
Protein: `+e[2].protein_grams+" grams. Feel free to mix and match ingredients.";function j(){o(1,p=!0),document.forms.macrosgenie.submit(),s("save",c)}function I(){s("cancel")}async function g(D){o(1,p=!0),D.preventDefault();const r=JSON.stringify({food_for_macros:c}),v=await fetch("/foodlog/[date]/generatefoodsuggestions",{method:"POST",headers:{"Content-Type":"application/json"},body:r}),G=await v.json();v.ok||console.log(G),o(0,i=G.generated_food),o(1,p=!1)}function S(){var D="",w=JSON.parse(i);return D=w.food_name+`
`+w.food_description+`

`+w.food_recipe+`
`,D+=`

Fat: `+w.total_fat_grams+" grams, Carbs: "+w.total_carbs_grams+" grams, Protein: "+w.total_protein_grams+" grams.",D}function b(){return JSON.parse(i)}function M(){c=this.value,o(2,c)}return a.$$set=D=>{"totalsData"in D&&o(9,e=D.totalsData)},[i,p,c,d,j,I,g,S,b,e,M]}class Ae extends we{constructor(t){super(),Ee(this,t,Re,Ke,ke,{totalsData:9})}}function Ce(a){let t,o,e;return o=new Fe({props:{size:"60",color:"#FF3E00",unit:"px",duration:"1s"}}),{c(){t=m("div"),oe(o.$$.fragment),this.h()},l(s){t=h(s,"DIV",{style:!0});var i=T(t);ae(o.$$.fragment,i),i.forEach(n),this.h()},h(){k(t,"display","flex"),k(t,"justify-content","center"),k(t,"padding","10px")},m(s,i){V(s,t,i),se(o,t,null),e=!0},i(s){e||(B(o.$$.fragment,s),e=!0)},o(s){H(o.$$.fragment,s),e=!1},d(s){s&&n(t),le(o)}}}function De(a){let t,o;return t=new Ae({props:{totalsData:a[12]}}),t.$on("save",a[9]),t.$on("cancel",a[10]),{c(){oe(t.$$.fragment)},l(e){ae(t.$$.fragment,e)},m(e,s){se(t,e,s),o=!0},p:Se,i(e){o||(B(t.$$.fragment,e),o=!0)},o(e){H(t.$$.fragment,e),o=!1},d(e){le(t,e)}}}function Me(a){let t,o,e,s,i,p,d,c,j,I,g,S,b,M,D,w,r,v,G,J,_,N,F,E,L,R,U,q,z,$,f,A,X;i=new je({props:{id:"foodautocomplete",name:"foodautocomplete",autofocus:!0,hideLabel:!0,focusAfterSelect:!0,placeholder:"Whatcha eatin'?",data:a[7],extract:a[8]}}),i.$on("keydown",a[11]);let K=a[1]&&Ce(),O=a[2]&&De(a);return{c(){t=m("link"),o=P(),e=m("div"),s=m("form"),oe(i.$$.fragment),p=P(),d=m("form"),c=m("input"),j=P(),I=m("div"),g=m("div"),S=m("a"),b=m("i"),M=P(),D=m("div"),w=Y("Food Log for "),r=Y(a[4]),v=P(),G=m("div"),J=m("a"),_=m("i"),N=P(),K&&K.c(),F=P(),E=m("div"),L=P(),R=m("div"),U=m("div"),q=P(),z=m("div"),$=m("div"),f=P(),O&&O.c(),A=ve(),this.h()},l(y){t=h(y,"LINK",{rel:!0,href:!0}),o=W(y),e=h(y,"DIV",{style:!0});var C=T(e);s=h(C,"FORM",{action:!0,method:!0});var ee=T(s);ae(i.$$.fragment,ee),ee.forEach(n),p=W(C),d=h(C,"FORM",{id:!0,action:!0,method:!0});var x=T(d);c=h(x,"INPUT",{type:!0,name:!0}),x.forEach(n),j=W(C),I=h(C,"DIV",{class:!0});var Q=T(I);g=h(Q,"DIV",{class:!0});var fe=T(g);S=h(fe,"A",{"data-sveltekit-reload":!0,href:!0});var ue=T(S);b=h(ue,"I",{class:!0,style:!0}),T(b).forEach(n),ue.forEach(n),fe.forEach(n),M=W(Q),D=h(Q,"DIV",{class:!0});var re=T(D);w=Z(re,"Food Log for "),r=Z(re,a[4]),re.forEach(n),v=W(Q),G=h(Q,"DIV",{class:!0});var ce=T(G);J=h(ce,"A",{"data-sveltekit-reload":!0,href:!0});var me=T(J);_=h(me,"I",{class:!0,style:!0}),T(_).forEach(n),me.forEach(n),ce.forEach(n),Q.forEach(n),N=W(C),K&&K.l(C),F=W(C),E=h(C,"DIV",{class:!0,id:!0});var Ne=T(E);Ne.forEach(n),L=W(C),R=h(C,"DIV",{style:!0});var he=T(R);U=h(he,"DIV",{id:!0,class:!0,style:!0}),T(U).forEach(n),he.forEach(n),q=W(C),z=h(C,"DIV",{style:!0});var pe=T(z);$=h(pe,"DIV",{id:!0,class:!0,style:!0}),T($).forEach(n),pe.forEach(n),C.forEach(n),f=W(y),O&&O.l(y),A=ve(),this.h()},h(){l(t,"rel","stylesheet"),l(t,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"),l(s,"action","?/addfood"),l(s,"method","POST"),l(c,"type","hidden"),l(c,"name","food"),l(d,"id","foodForm"),l(d,"action","?/addfood"),l(d,"method","POST"),l(b,"class","fa fa-arrow-circle-left"),k(b,"font-size","36px"),k(b,"color","blue"),k(b,"padding","10px"),l(S,"data-sveltekit-reload",""),l(S,"href","/foodlog/"+a[6]),l(g,"class","left-image"),l(D,"class","foodheader"),l(_,"class","fa fa-arrow-circle-right"),k(_,"font-size","36px"),k(_,"color","blue"),k(_,"padding","10px"),l(J,"data-sveltekit-reload",""),l(J,"href","/foodlog/"+a[5]),l(G,"class","right-image"),l(I,"class","container"),l(E,"class","grid"),l(E,"id","foodLog"),l(U,"id","totals"),l(U,"class","ag-theme-alpine"),k(U,"height","22vh"),k(U,"width","100%"),k(R,"display","flex"),k(R,"justify-content","center"),k(R,"align-items","center"),l($,"id","datagrid"),l($,"class","ag-theme-alpine"),k($,"height","170vh"),k($,"width","100%"),k(z,"display","flex"),k(z,"justify-content","center"),k(z,"align-items","center"),k(e,"text-align","center"),k(e,"margin","25px auto"),k(e,"width","85%"),k(e,"max-width","1200px")},m(y,C){V(y,t,C),V(y,o,C),V(y,e,C),u(e,s),se(i,s,null),u(e,p),u(e,d),u(d,c),u(e,j),u(e,I),u(I,g),u(g,S),u(S,b),u(I,M),u(I,D),u(D,w),u(D,r),u(I,v),u(I,G),u(G,J),u(J,_),u(e,N),K&&K.m(e,null),u(e,F),u(e,E),u(e,L),u(e,R),u(R,U),a[14](U),u(e,q),u(e,z),u(z,$),a[15]($),V(y,f,C),O&&O.m(y,C),V(y,A,C),X=!0},p(y,[C]){y[1]?K?C&2&&B(K,1):(K=Ce(),K.c(),B(K,1),K.m(e,F)):K&&(ie(),H(K,1,1,()=>{K=null}),de()),y[2]?O?(O.p(y,C),C&4&&B(O,1)):(O=De(y),O.c(),B(O,1),O.m(A.parentNode,A)):O&&(ie(),H(O,1,1,()=>{O=null}),de())},i(y){X||(B(i.$$.fragment,y),B(K),B(O),X=!0)},o(y){H(i.$$.fragment,y),H(K),H(O),X=!1},d(y){y&&n(t),y&&n(o),y&&n(e),le(i),K&&K.d(),a[14](null),a[15](null),y&&n(f),O&&O.d(y),y&&n(A)}}}function ne(a){return a.data.label==="Target Totals"}function ze(a){for(var t=document.getElementById("foodLog").offsetWidth,o=[],e=[],s=0,i=a.columnApi.getColumns(),p=0;p<i.length;p++){let d=i[p];if(s+=d.getMinWidth(),s>t){o.push("Food"),o.push("Fat"),o.push("Carbs"),o.push("Protein"),e.push("Qty"),e.push("Kcals"),a.columnApi.setColumnsVisible(o,!0),a.columnApi.setColumnsVisible(e,!1),a.api.sizeColumnsToFit();break}}a.api.sizeColumnsToFit()}function Ge(a){for(var t=document.getElementById("totals").offsetWidth,o=[],e=[],s=0,i=a.columnApi.getColumns(),p=0;p<i.length;p++){let d=i[p];if(s+=d.getMinWidth(),s>t){o.push("Totals"),o.push("Fat"),o.push("Carbs"),o.push("Protein"),e.push("Empty"),e.push("Kcals"),a.columnApi.setColumnsVisible(o,!0),a.columnApi.setColumnsVisible(e,!1),a.api.sizeColumnsToFit();break}}a.api.sizeColumnsToFit()}async function Le(a,t){const o=parseInt(t.protein_grams),e=parseInt(t.carbs_grams),s=parseInt(t.fat_grams),i=o*4+e*4+s*9;t.Kcals=i,a.setDataValue("Kcals",t.Kcals);const p=JSON.stringify(t),d=await fetch("/foodlog/[date]/updaterecord",{method:"POST",headers:{"Content-Type":"application/json"},body:p}),c=await d.json();return d.ok||console.log(c),c}function Ue(a,t,o){let{data:e}=t;var s,i,p=!0;let d=!1;var c,j;const I=e.today,g=new Date(I).toISOString().split("T")[0];var S=new Date(I);S.setDate(S.getDate()+1);const b=S.toISOString().split("T")[0];var M=new Date(I);M.setDate(M.getDate()-1);const D=M.toISOString().split("T")[0];let w=e.foodReferences;w.some(f=>f.food_name.indexOf("cmd")>0)||w.push({user_id:0,food_name:"💪 /cmd Suggest some food to fit my macros",food_id:0});const r=f=>f.food_name;function v(){o(2,d=!0)}function G(){o(2,d=!1),o(1,p=!0)}function J(){o(2,d=!1)}const _=f=>{if(f.key=="Enter"){const A=document.getElementById("foodautocomplete").value;A.includes("/cmd")?v():(document.forms.foodForm.elements.food.value=A,document.forms.foodForm.submit(),o(1,p=!0))}};let N=[{headerName:"Food",field:"food_name",editable:!0,colId:"Food",minWidth:100,align:"left"},{headerName:"Qty",field:"food_qty",editable:!0,colId:"Qty",minWidth:100},{headerName:"Fat, g",field:"fat_grams",editable:!0,colId:"Fat",minWidth:70},{headerName:"Carbs, g",field:"carbs_grams",editable:!0,colId:"Carbs",minWidth:70},{headerName:"Protein, g",field:"protein_grams",editable:!0,colId:"Protein",minWidth:70},{headerName:"Kcals",field:"kkcals",colId:"Kcals",minWidth:120}],F=[{headerName:"Totals",field:"label",editable:!1,colId:"Totals",minWidth:100,cellStyle:f=>f.value==="Target Totals"?{color:"white",backgroundColor:"lightblue"}:f.value==="Difference"?{color:"white",backgroundColor:"red"}:{color:"white",backgroundColor:"grey"}},{headerName:"",field:"",editable:!1,colId:"Empty",minWidth:100},{headerName:"Fat, g",field:"fat_grams",editable:f=>ne(f),colId:"Fat",minWidth:70},{headerName:"Carbs, g",field:"carbs_grams",editable:f=>ne(f),colId:"Carbs",minWidth:70},{headerName:"Protein, g",field:"protein_grams",editable:f=>ne(f),colId:"Protein",minWidth:70},{headerName:"Kcals",field:"kcals",editable:!1,colId:"Kcals",minWidth:120}],E=[e.targetTotals,e.calculatedTotals,e.differenceTotals];function L(f){if(f.keyCode===46){const A=R.api.getSelectedRows();R.api.applyTransaction({remove:A})}}let R={columnDefs:N,rowData:e.rowData,rowSelection:"single",onGridReady:f=>{document.addEventListener("keydown",L)},onCellValueChanged(f){f.colDef.colId!=="Kcals"&&Le(f.node,f.data)},onGridSizeChanged:ze},U={columnDefs:F,rowData:E,onCellValueChanged(f){q(f.node,f.data,f.column.colId)},onGridSizeChanged:Ge};async function q(f,A,X){if(X==="Kcals")return;const K=parseInt(A.protein_grams),O=parseInt(A.carbs_grams),y=parseInt(A.fat_grams),C=K*4+O*4+y*9;A.Kcals=C,A.feeding_date=I,f.setDataValue("Kcals",A.Kcals,{suppressCellChangedEvent:!0});const ee=JSON.stringify(A),x=await fetch("/foodlog/[date]/updatetargettotals",{method:"POST",headers:{"Content-Type":"application/json"},body:ee}),Q=await x.json();return x.ok||console.log(Q),Q}Pe(()=>{i=new ye(s,R),j=new ye(c,U),o(1,p=!1)}),We(()=>{i&&i.destroy(),j&&j.destroy()});function z(f){_e[f?"unshift":"push"](()=>{c=f,o(3,c)})}function $(f){_e[f?"unshift":"push"](()=>{s=f,o(0,s)})}return a.$$set=f=>{"data"in f&&o(13,e=f.data)},[s,p,d,c,g,b,D,w,r,G,J,_,E,e,z,$]}class Ye extends we{constructor(t){super(),Ee(this,t,Ue,Me,ke,{data:13})}}export{Ye as component};
