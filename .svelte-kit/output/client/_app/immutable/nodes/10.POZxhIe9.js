import{s as V,e as y,a as N,c as b,b as D,f as d,g as E,l as L,q as g,u as h,i as _,h as R,A as F,r as W,x as j,y as x,z as P}from"../chunks/scheduler.D5qmQzhB.js";import{S as M,i as O,t as C,a as I,c as q,b as z,d as G,m as H,e as K,g as Q}from"../chunks/index.eUYc991i.js";import{G as A}from"../chunks/ag-theme-alpine.3A7TJ96k.js";/* empty css                                                      */import{C as J}from"../chunks/Chasing.mmy04f5_.js";function S(l){let e,a,i;return a=new J({props:{size:"60",color:"#FF3E00",unit:"px",duration:"1s"}}),{c(){e=y("div"),z(a.$$.fragment),this.h()},l(r){e=b(r,"DIV",{style:!0});var o=D(e);G(a.$$.fragment,o),o.forEach(d),this.h()},h(){h(e,"display","flex"),h(e,"justify-content","center"),h(e,"padding","10px")},m(r,o){_(r,e,o),H(a,e,null),i=!0},i(r){i||(C(a.$$.fragment,r),i=!0)},o(r){I(a.$$.fragment,r),i=!1},d(r){r&&d(e),K(a)}}}function U(l){let e,a,i,r,o,u="<h3>Food Reference List</h3>",m,c,f,p,v,k,n=l[1]&&S();return{c(){e=y("form"),a=y("input"),i=N(),n&&n.c(),r=N(),o=y("center"),o.innerHTML=u,m=N(),c=y("div"),f=y("div"),this.h()},l(s){e=b(s,"FORM",{action:!0,method:!0});var t=D(e);a=b(t,"INPUT",{name:!0,class:!0}),t.forEach(d),i=E(s),n&&n.l(s),r=E(s),o=b(s,"CENTER",{"data-svelte-h":!0}),L(o)!=="svelte-1psm8ym"&&(o.innerHTML=u),m=E(s),c=b(s,"DIV",{style:!0});var w=D(c);f=b(w,"DIV",{id:!0,class:!0,style:!0}),D(f).forEach(d),w.forEach(d),this.h()},h(){g(a,"name","food"),a.value="Search for or add food to the reference list",g(a,"class","svelte-brt59l"),g(e,"action","?/addfood"),g(e,"method","POST"),g(f,"id","datagrid"),g(f,"class","ag-theme-alpine"),h(f,"height","70vh"),h(f,"width","100%"),h(c,"display","flex"),h(c,"justify-content","center"),h(c,"align-items","center")},m(s,t){_(s,e,t),R(e,a),_(s,i,t),n&&n.m(s,t),_(s,r,t),_(s,o,t),_(s,m,t),_(s,c,t),R(c,f),l[5](f),p=!0,v||(k=[F(a,"focus",X),F(a,"keydown",l[2]),F(a,"input",l[3])],v=!0)},p(s,[t]){s[1]?n?t&2&&C(n,1):(n=S(),n.c(),C(n,1),n.m(r.parentNode,r)):n&&(Q(),I(n,1,1,()=>{n=null}),q())},i(s){p||(C(n),p=!0)},o(s){I(n),p=!1},d(s){s&&(d(e),d(i),d(r),d(o),d(m),d(c)),n&&n.d(s),l[5](null),v=!1,W(k)}}}async function B(l,e){const a=parseInt(e.protein_grams),i=parseInt(e.carbs_grams),r=parseInt(e.fat_grams),o=a*4+i*4+r*9;console.log("protein "+a+" fat "+r+" carbs "+i+"Kcals: "+o),e.kkcals=o,l.setDataValue("kkcals",e.kkcals);const u=JSON.stringify(e);if(!(await fetch("/reference/updaterecord",{method:"POST",headers:{"Content-Type":"application/json"},body:u})).ok)throw Error(json.message)}const X=l=>l.target.select();function Y(l,e,a){let{data:i}=e;var r,o,u=!0;let m="";var c=i.rowData;let p={columnDefs:[{headerName:"Food",field:"food_name",editable:!0,minWidth:100},{headerName:"Qty",field:"food_qty",editable:!0,minWidth:70},{headerName:"Fat, g",field:"fat_grams",editable:!0,minWidth:70},{headerName:"Carbs, g",field:"carbs_grams",editable:!0,minWidth:70},{headerName:"Protein, g",field:"protein_grams",editable:!0,minWidth:70},{headerName:"Kcals",field:"kkcals",editable:!0,minWidth:120}],rowData:c,onCellValueChanged(t){B(t.node,t.data)}};j(()=>{o=new A(r,p),a(1,u=!1)}),x(()=>{o&&o.destroy()});const v=t=>{t.key=="Enter"&&a(1,u=!0)},k=t=>{m=t.target.value,n(),p.api.setRowData(c)};function n(){c=i.rowData.filter(t=>{const w=t.food_name.toLowerCase(),T=m.toLowerCase();return w.includes(T)})}function s(t){P[t?"unshift":"push"](()=>{r=t,a(0,r)})}return l.$$set=t=>{"data"in t&&a(4,i=t.data)},[r,u,v,k,i,s]}class re extends M{constructor(e){super(),O(this,e,Y,U,V,{data:4})}}export{re as component};
