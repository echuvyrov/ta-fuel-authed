{"version":3,"file":"hooks.server-cd577cbf.js","sources":["../../../.svelte-kit/adapter-node/chunks/hooks.server.js"],"sourcesContent":["import { d as dev } from \"./environment.js\";\nimport { d as private_env } from \"./internal.js\";\nimport { Auth } from \"@auth/core\";\nimport GitHub from \"@auth/core/providers/github\";\nimport Twitter from \"@auth/core/providers/twitter\";\nasync function getSession(req, config) {\n  config.secret ??= private_env.AUTH_SECRET;\n  config.trustHost ??= true;\n  const url = new URL(\"/api/auth/session\", req.url);\n  const request = new Request(url, { headers: req.headers });\n  const response = await Auth(request, config);\n  const { status = 200 } = response;\n  const data = await response.json();\n  if (!data || !Object.keys(data).length)\n    return null;\n  if (status === 200)\n    return data;\n  throw new Error(data.message);\n}\nconst actions = [\n  \"providers\",\n  \"session\",\n  \"csrf\",\n  \"signin\",\n  \"signout\",\n  \"callback\",\n  \"verify-request\",\n  \"error\"\n];\nfunction AuthHandle(prefix, authOptions) {\n  return function({ event, resolve }) {\n    const { url, request } = event;\n    event.locals.getSession ??= () => getSession(request, authOptions);\n    const action = url.pathname.slice(prefix.length + 1).split(\"/\")[0];\n    if (!actions.includes(action) || !url.pathname.startsWith(prefix + \"/\")) {\n      return resolve(event);\n    }\n    return Auth(request, authOptions);\n  };\n}\nfunction SvelteKitAuth(options) {\n  const { prefix = \"/auth\", ...authOptions } = options;\n  authOptions.secret ??= private_env.AUTH_SECRET;\n  authOptions.trustHost ??= !!(private_env.AUTH_TRUST_HOST ?? private_env.VERCEL ?? dev);\n  return AuthHandle(prefix, authOptions);\n}\nconst GITHUB_ID = process.env.GITHUB_ID;\nconst GITHUB_SECRET = process.env.GITHUB_SECRET;\nconst TWITTER_ID = process.env.TWITTER_ID;\nconst TWITTER_SECRET = process.env.TWITTER_SECRET;\nconst handle = SvelteKitAuth({\n  debug: true,\n  providers: [\n    GitHub({\n      clientId: GITHUB_ID,\n      clientSecret: GITHUB_SECRET\n    }),\n    Twitter({\n      clientId: TWITTER_ID,\n      clientSecret: TWITTER_SECRET,\n      version: \"2.0\"\n    })\n  ]\n});\nexport {\n  handle\n};\n"],"names":[],"mappings":"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"}