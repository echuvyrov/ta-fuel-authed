{"version":3,"file":"SmartAIThingie-92ddd1ac.js","sources":["../../../.svelte-kit/adapter-node/chunks/SmartAIThingie.js"],"sourcesContent":["import \"./index.js\";\nimport dotenv from \"dotenv\";\ndotenv.config();\nclass SmartAIThingie {\n  /* a function that calls GPT-3 and returns the result */\n  static async ask(prompt) {\n    const response = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \" + process.env.GPT3_API_KEY\n      },\n      body: JSON.stringify({\n        model: \"gpt-3.5-turbo\",\n        messages: [{ \"role\": \"user\", \"content\": prompt }],\n        max_tokens: 512,\n        temperature: 1\n      })\n    });\n    var data = await response.json();\n    return data;\n  }\n  static askForJSON(prompt) {\n    var modifiedPrompt = prompt + \"\";\n    return this.ask(modifiedPrompt);\n  }\n  /* a function that calls DALL-E to generate an image and returns it as a base64 string */\n  static async generateImage(food) {\n    const prompt = \"A creative, appetizing photo of \" + food + \" using gourmet food photography in the style of Caroline Losse, with the following words '\" + food + \"' in it\";\n    const response = await fetch(\"https://api.openai.com/v1/images/generations\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \" + process.env.GPT3_API_KEY\n      },\n      body: JSON.stringify({\n        prompt,\n        n: 1,\n        size: \"256x256\",\n        response_format: \"b64_json\"\n      })\n    });\n    var imageData = await response.json();\n    var imageBase64 = imageData.data[0].b64_json;\n    return imageBase64;\n  }\n}\nclass NutritionSmartAIThingie extends SmartAIThingie {\n  /* declare a class-wide variable to hold the food name */\n  static food_name = \"\";\n  static async ask(prompt) {\n    var nutritionPrompt = prompt;\n    return await super.ask(nutritionPrompt);\n  }\n  static async askForJSON(prompt) {\n    this.food_name = prompt;\n    var nutritionPrompt = \"Show nutrition data for \" + prompt + \" and return it in the format: Food: Quantity: Calories: Fat: Carbs: Protein\";\n    var rawResponse = await super.askForJSON(nutritionPrompt);\n    var parsedResponse = await this.parseResponse(rawResponse);\n    var nutritionData = await this.parseNutrition(parsedResponse);\n    return nutritionData;\n  }\n  /* a function to create a JSON object from a string with line breaks as separators for different elements */\n  static async parseResponse(rawResponse) {\n    console.log(\"rawResponse: \" + JSON.stringify(rawResponse));\n    var parsedResponse = {};\n    var lines = rawResponse.choices[0].message.content.split(\"\\n\");\n    for (var i = 0; i < lines.length; i++) {\n      var line = lines[i];\n      if (line.indexOf(\":\") > -1) {\n        var key = line.substring(0, line.indexOf(\":\"));\n        var value = line.substring(line.indexOf(\":\") + 1);\n        parsedResponse[key] = value;\n      } else if (line.indexOf(\"-\") > -1) {\n        var key = line.substring(0, line.indexOf(\"-\"));\n        var value = line.substring(line.indexOf(\"-\") + 1);\n        parsedResponse[key] = value;\n      }\n    }\n    return parsedResponse;\n  }\n  static parseNutrition(parsedResponse) {\n    var nutritionData = {};\n    nutritionData.food_name = this.food_name;\n    if (parsedResponse[\"Calories\"]) {\n      nutritionData[\"kkcals\"] = parseFloat(parsedResponse[\"Calories\"].replace(/[^0-9.]/g, \"\"));\n    } else {\n      nutritionData[\"kkcals\"] = 0;\n    }\n    if (parsedResponse[\"Quantity\"]) {\n      nutritionData[\"food_qty\"] = parseFloat(parsedResponse[\"Quantity\"].match(/\\d+/)[0]);\n    } else {\n      nutritionData[\"food_qty\"] = 0;\n    }\n    if (parsedResponse[\"Calories\"]) {\n      nutritionData[\"kkcals\"] = parseFloat(parsedResponse[\"Calories\"].replace(/[^0-9.]/g, \"\"));\n    } else {\n      nutritionData[\"kkcals\"] = 0;\n    }\n    if (parsedResponse[\"Protein\"]) {\n      nutritionData[\"protein_grams\"] = parseFloat(parsedResponse[\"Protein\"].replace(/[^0-9.]/g, \"\"));\n    } else {\n      nutritionData[\"protein_grams\"] = 0;\n    }\n    if (parsedResponse[\"Fat\"]) {\n      nutritionData[\"fat_grams\"] = parseFloat(parsedResponse[\"Fat\"].replace(/[^0-9.]/g, \"\"));\n    } else {\n      nutritionData[\"fat_grams\"] = 0;\n    }\n    if (parsedResponse[\"Carbs\"]) {\n      nutritionData[\"carbs_grams\"] = parseFloat(parsedResponse[\"Carbs\"].replace(/[^0-9.]/g, \"\"));\n    } else {\n      nutritionData[\"carbs_grams\"] = 0;\n    }\n    return nutritionData;\n  }\n}\nclass TrainingSmartAIThingie extends SmartAIThingie {\n  static async ask(prompt) {\n    var trainingPrompt = prompt;\n    return await super.ask(trainingPrompt);\n  }\n  static async askForTrainingProgramJSON(prompt) {\n    var trainingProgramPrompt = \"Return an array of JSON objects representing                 the following exercise program, removing all non-JSON characters. Each                 JSON objects should be in the format { day_name, day_description }. Do not                confirm, do not output anything else other than JSON array.\" + prompt;\n    var rawResponse = await super.askForJSON(trainingProgramPrompt);\n    var trainingData = await this.parseTraining(rawResponse);\n    return trainingData;\n  }\n  /* a function to create an array from a string with line breaks as separators for different elements */\n  static async parseTraining(rawResponse) {\n    var rawTrainingJSON = rawResponse.choices[0].message.content;\n    console.log(\"rawTrainingJSON: \" + rawTrainingJSON);\n    console.log(\"rawTrainingJSON: \" + JSON.stringify(JSON.parse(rawTrainingJSON)));\n    return JSON.parse(rawTrainingJSON);\n  }\n}\nexport {\n  NutritionSmartAIThingie as N,\n  TrainingSmartAIThingie as T\n};\n"],"names":[],"mappings":"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"}